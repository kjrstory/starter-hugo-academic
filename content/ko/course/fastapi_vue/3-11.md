---
title: 3-11 게시물 수정과 삭제
date: '2023-11-01'
type: book
weight: 21
math: true
tags:
  - Python
  - FastAPI
  - Vue
---

- `완성 소스` : https://github.com/kjrstory/fastapi_vue/tree/v3.11
- `점프 투 FastAPI 문서` : https://wikidocs.net/177112

## 1. 수정 화면 버튼 삽입

`[파일명: frontend/src/views/PageHome.vue]`
```
        <div class="card-body">
            <div class="card-text" style="white-space: pre-line;">{{question.content}}</div>	            <div class="card-text" style="white-space: pre-line;">{{question.content}}</div>
            <div class="d-flex justify-content-end">	            <div class="d-flex justify-content-end">
                <div v-if="question.modify_date" class="badge bg-light text-dark p-2 text-start mx-3">
                    <div class="mb-2">modified at</div>
                    <div>{{ formatDate(question.modify_date) }}</div>
                </div>

                <div class="badge bg-light text-dark p-2 text-start">	                <div class="badge bg-light text-dark p-2 text-start">
                    <div class="mb-2" v-if="question.user">{{ question.user.username }}</div>	                    <div class="mb-2" v-if="question.user">{{ question.user.username }}</div>
                    <div class="mb-2" v-else></div>	                    <div class="mb-2" v-else></div>
                    <div>{{ formatDate(question.create_date) }}</div>	                    <div>{{ formatDate(question.create_date) }}</div>
                </div>	                </div>
            </div>	            </div>
            <div class="my-3" v-if="question.user && this.$store.state.username === question.user.username">
               <router-link :to="'/question-modify/' + question.id" class="btn btn-sm btn-outline-secondary">수정</router-link>
               <button class="btn btn-sm btn-outline-secondary" @click="deleteQuestion(question.id)">삭제</button>
            </div>

        </div>	        </div>
    </div>	    </div>


@@ -27,12 +37,21 @@
        <div class="card-body">	        <div class="card-body">
            <div class="card-text" style="white-space: pre-line;">{{answer.content}}</div>	            <div class="card-text" style="white-space: pre-line;">{{answer.content}}</div>
            <div class="d-flex justify-content-end">	            <div class="d-flex justify-content-end">
                <div v-if="answer.modify_date" class="badge bg-light text-dark p-2 text-start mx-3">
                    <div class="mb-2">modified at</div>
                    <div>{{ formatDate(answer.modify_date) }}</div>
                </div>
                <div class="badge bg-light text-dark p-2 text-start">	                <div class="badge bg-light text-dark p-2 text-start">
                   <div class="mb-2" v-if="answer.user">{{ answer.user.username }}</div>	                   <div class="mb-2" v-if="answer.user">{{ answer.user.username }}</div>
                   <div class="mb-2" v-else></div>	                   <div class="mb-2" v-else></div>
                   <div>{{ formatDate(question.create_date) }}</div>	                   <div>{{ formatDate(question.create_date) }}</div>
                </div>	                </div>
            </div>	            </div>
            <div class="my-3" v-if="answer.user && this.$store.state.username === answer.user.username">
               <router-link :to="'/answer-modify/' + answer.id" class="btn btn-sm btn-outline-secondary">수정</router-link>
               <button class="btn btn-sm btn-outline-secondary" @click="deleteAnswer(answer.id)">삭제</button>
            </div>

        </div>	        </div>
    </div>	    </div>



<script>
(... 생략 ...)
  methods: {
(... 생략 ...)
    deleteQuestion(question_id) {
      if(confirm('정말로 삭제하시겠습니까?')) {
        let url = "/api/question/delete";
        let params = {
          question_id: question_id
        }
        fastapi('delete', url, params, () => {
          this.$router.push("/")
        })    
      }
    },
    deleteAnswer(answer_id) {
      if(confirm('정말로 삭제하시겠습니까?')) {
        let url = "/api/answer/delete";
        let params = {
          answer_id: answer_id
        }
        fastapi('delete', url, params, () => {
            this.getQuestion()
        })
      }
    }
  },  
  created() {
    this.getQuestion();
  }
}
</script>
```


---
## 2. 라우터 등록

`[파일명: frontend/src/router/index.js]`
```javascript{hl_lines=[4,5,"15-25"]}
import QuestionCreate from '@/views/QuestionCreate.vue'
import UserCreate from "@/views/UserCreate.vue"
import UserLogin from "@/views/UserLogin.vue"
import QuestionModify from "@/views/QuestionModify.vue"
import AnswerModify from "@/views/AnswerModify.vue"

const routes = [
(... 생략 ...)
  {
    path: '/user-login',
    name: 'UserLogin',
    component: UserLogin
  },
  {
    path: '/question-modify/:question_id',
    name: 'QuestionModify',
    component: QuestionModify,
    props: true
  },
  {
    path: '/answer-modify/:answer_id',
    name: 'AnswerModify',
    component: AnswerModify,
    props: true
  },
]

const router = createRouter({
  history: createWebHistory(process.env.BASE_URL),
  routes
})

export default router
```


## 3. 질문 수정 화면 작성

`[파일명: frontend/src/views/QuestionModify.vue]`
```vue
<template>
  <div class="container">
    <h5 class="my-3 border-bottom pb-2">질문 수정</h5>
    <form @submit.prevent="updateQuestion" class="my-3">
      <div class="mb-3">
        <label for="content">내용</label>
        <textarea class="form-control" rows="10" v-model="content"></textarea>
      </div>
      <button type="submit" class="btn btn-primary">수정하기</button>
    </form>
  </div>
</template>

<script>
import fastapi from '../lib/api'
export default {
  props: {
    question_id: {
      type: String,
      required: true
    }
  },
  data() {
    return {
      subject: '',
      content: '',
    }
  },
  mounted() {
    let url = '/api/question/detail/' + this.question_id;
    fastapi("get", url, {}, (json) => {
        this.subject = json.subject
        this.content = json.content
    })
  },
  methods: {
    updateQuestion() {
      let url = '/api/question/update';
      let params = {
        question_id: this.question_id,
        subject: this.subject,
        content: this.content
      };
      fastapi('put', url, params, () => {
          this.$router.push("/detail/"+this.question_id)
      })
    }
  }
};
</script>
```

```
## 4. 답변 수정 화면 작성

`[파일명: frontend/src/views/AnswerModify.vue]`
```vue
<template>
  <div class="container">
    <h5 class="my-3 border-bottom pb-2">답변 수정</h5>
    <form @submit.prevent="updateAnswer" class="my-3">
      <div class="mb-3">
        <label for="content">내용</label>
        <textarea class="form-control" rows="10" v-model="content"></textarea>
      </div>
      <button type="submit" class="btn btn-primary">수정하기</button>
    </form>
  </div>
</template>

<script>
import fastapi from '../lib/api'
export default {
  props: {
    answer_id: {
      type: String,
      required: true
    },
  },
  data() {
    return {
      question_id: 0,  
      content: '',
    }
  },
  mounted() {
    fastapi("get", "/api/answer/detail/" + this.answer_id, {}, (json) => {
        this.question_id = json.question_id
        this.content = json.content
    })
  },
  methods: {
    updateAnswer() {
      let url = '/api/answer/update';
      let params = {
        answer_id: this.answer_id,
        content: this.content
      };
      fastapi('put', url, params, () => {
          this.$router.push("/detail/"+this.question_id)
      })
    }
  }
};
</script>
```
