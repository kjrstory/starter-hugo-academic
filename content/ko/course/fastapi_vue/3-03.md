---
title: 3-03 스토어
date: '2023-11-01'
type: book
weight: 13
math: true
tags:
  - Python
  - FastAPI
  - Vue
---

- `완성 소스` : https://github.com/kjrstory/fastapi_vue/tree/v3.03
- `점프 투 FastAPI 문서` : https://wikidocs.net/176723



## Vue 스토어 패키지 설치 및 설정

Vue에서 스토어 기능을 구현하기 위해서는 Vuex 패키지가 필요하다. 

```bash
frontend % npm save vuex
```

스토어 폴더를 생성하고 index.js 파일을 생성한다.

`[파일명: frontend/src/store/index.js]`
```javascipt
import { createStore } from 'vuex'
import persistedstate from 'vuex-persistedstate';

const store = createStore({
  plugins: [persistedstate()],
  state: {
    page: 0
  },
  mutations: {
    setPage(state, payload) {
      state.page = payload
    }
  },
  actions: {
    setPage(context, payload) {
      context.commit('setPage', payload)
    }
  },
  getters: {
    getPage: (state) => state.page
  }
})

export default store
```




그 후 main.js파일을 수정하여 스토어 기능을 사용한다.

```javascript{hl_lines=[5,8]}
import { createApp } from 'vue'
import 'bootstrap/dist/css/bootstrap.min.css'
import 'bootstrap/dist/js/bootstrap.min.js'
import App from './App.vue'
import router from './router'
import store from './store'

const app = createApp(App)
app.use(router).use(store).mount('#app')
```

## 스토어 변수 사용하기


이제 페이징에 스토어 변수를 사용해보자.

`[파일명: frontend/src/views/PageDetail.vue]`
```vue{hl_lines=["13-15",28]}
<script>
  import fastapi from '../lib/api';

  export default {
    data() {
      return {
        questionList: [],
        size: 10,
        total: 0,
      };
    },
    computed: {
      page() {
        return this.$store.state.page;
      },  
      totalPage() {
        return Math.ceil(this.total / this.size);
      },
    },
    methods: {
      getQuestionList(_page) {
        let url = "/api/question/list"
        let params = { 
            page: _page,
            size: this.size}
        fastapi('get', url, params, (json) => {
          this.questionList = json.question_list;
          this.$store.dispatch('setPage',_page);
          this.total = json.total;
        });
      }
    },
    created() {
      this.getQuestionList(this.$store.getters.getPage);
    }
  }
</script>
```

computed 속성에 this.$store.state.<스토어변수> 같이 사용하면 스토어 변수를 사용할 수 있다.



## Pybo 로고


`[파일명: frontend/src/components/Navigation.vue]`
```vue{hl_lines=[4, "14-17"]}
<template>
  <nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
    <div class="container-fluid">
      <router-link to="/" class="navbar-brand" @click="setPage(0)">Pybo</router-link>
      <button 
        class="navbar-toggler" 
        type="button" 
	@@ -25,3 +25,13 @@
    </div>
  </nav>
</template>
(... 생략 ...)
<script>
export default {
  methods: {
    setPage(page) {
      this.$store.dispatch('setPage', page);
    }
  }
}
</script>
```


## 질문 상세 페이지에 질문 목록 버튼 추가

`[파일명: frontend/src/views/PageDetail.vue]`

```vue
<template>
<div class="container my-3">
    <!-- 질문 -->
    <h2 class="border-bottom py-2">{{ question.subject }}</h2>
    <div class="card my-3">
        <div class="card-body">
            <div class="card-text" style="white-space: pre-line;">{{question.content}}</div>
            <div class="d-flex justify-content-end">
                <div class="badge bg-light text-dark p-2">
                    {{question.create_date}}
                </div>
            </div>
        </div>
    </div>

    <div class="mt-4">
      <router-link to="/" class="btn btn-secondary">
        목록으로
      </router-link>
    </div>

    <!-- 답변 목록 -->
```
