{{ $destination := .Get "src" }}
{{ $is_remote := strings.HasPrefix $destination "http" }}
{{ $caption := .Get "caption" | default (.Get "title") | default "" }}{{/* Support legacy `title` option. */}}
{{ $zoom := eq (.Get "lightbox" | default "true") "true" }}
{{ $id := anchorize (.Get "id" | default ($caption | plainify)) }}
{{ $alt := .Get "alt" | default ($caption | plainify) }}
{{ $link := .Get "link" }}
{{ $zoom = cond (ne $link "") false $zoom }}
{{ $img_class := "" }}
{{ if eq (.Get "theme" | lower) "light" }}{{ $img_class = printf "%s img-light" $img_class }}{{end}}
{{ if eq (.Get "theme" | lower) "dark" }}{{ $img_class = printf "%s img-dark" $img_class }}{{end}}

{{/* Workaround Hugo v0.81 error on Windows when `resources.Get (path.Join "media" <URL>)` */}}
{{- $img := "" -}}
{{- if not $is_remote -}}
  {{- $img = (.Page.Resources.ByType "image").GetMatch $destination -}}
  {{- if not $img -}}
    {{- $img = resources.Get (path.Join "media" $destination) -}}
  {{- end -}}
{{- end -}}


<div class="bookshelf">
  <div class="book">
     <div class="side spine">
        <span class="spine-title"> {{ $alt }} </span>
              <span class="spine-author">
                {{ $id }}
              </span>
     </div>
     <div class="side top"></div>
     <div
              class="side cover"
              style="background-image: url({{ $destination | safeURL }}); cursor:pointer;"
              onclick="location.href='{{ $link }}'"
      ></div>
  </div>
</div>

